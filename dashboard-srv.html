
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Dashboard</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        *, *::before, *::after {
            box-sizing: inherit;
        }

        body {
            display: flex;
            flex-wrap: wrap;
            overflow: hidden;
        }

        .column {
            display: flex;
            flex-direction: column;
            width: 50%;
            height: 100%;
            overflow: hidden;
        }

        .iframe-container, .half-width-container {
            border: 2px white;
            margin: 2px;
            flex-grow: 1;
            overflow: hidden;
        }

        .half-width-container {
            display: flex;
            width: calc(100% - 4px);
        }

        .half-width-iframe {
            flex: 1;
            overflow: hidden;
            border-right: 4px solid white;
        }

        .half-width-iframe:last-child {
            border-right: none;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="column left-column">
        <div class="iframe-container">
            <!-- Radar iframe with dynamic src -->
            <iframe id="radar-frame" src=""></iframe>
        </div>
        <div class="iframe-container">
            <iframe src="performance.html"></iframe>
        </div>
    </div>
    <div class="column right-column">
        <div class="half-width-container">
            <div class="half-width-iframe">
                <iframe src="countdown.html"></iframe> <!-- Use clock or countdown -->
            </div>
            <div class="half-width-iframe">
                <iframe src="safety.html"></iframe>
            </div>
        </div>
        <div class="iframe-container">
            <iframe src="text_rotator.html"></iframe>
        </div>
        <div class="iframe-container">
            <iframe src="gauge.html"></iframe>
        </div>
    </div>

    <script>
        // Fetch config.json
        async function fetchConfig() {
            try {
                const response = await fetch('config.json');
                if (!response.ok) throw new Error("Failed to load config.json");
                return await response.json();
            } catch (err) {
                console.error("Error fetching config:", err);
                return {};
            }
        }

        // Refresh iframes
        function refreshIframes() {
            var iframes = document.querySelectorAll('iframe');
            iframes.forEach(function(iframe) {
                iframe.contentWindow.location.reload(true);
            });
        }

        // Set up auto-refresh every 15 minutes
        setInterval(refreshIframes, 15 * 60 * 1000);

        // Load config and update radar iframe
        fetchConfig().then(config => {
            console.log("Loaded config:", config); // ðŸ‘ˆ Logs everything from config.json
            if (config.radarUrl) {
                const radarFrame = document.getElementById('radar-frame');
                radarFrame.src = config.radarUrl;
                console.log("Radar URL set to:", config.radarUrl); // ðŸ‘ˆ Confirms radar URL applied
            } else {
                console.warn("No radarUrl found in config.json");
            }
        });
    </script>
</body>
</html>
